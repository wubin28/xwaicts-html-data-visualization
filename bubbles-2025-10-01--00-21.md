 › 请在 PLAN
    模式补充“自动检测首个包含候选列名的行作为表头”的策略，并在 EXECUTE
    中实现该行作为 header 重读 Excel。

 ● todo-2025-09-30--23-59.md - read file
   ⎿ Read 128 lines

 ● todo-2025-09-30--23-59.md - edit file
     ⎿ Edited todo-2025-09-30--23-59.md with 30 additions
         100 + ## Supplement Plan: Auto-detect header row and re-read Excel
         101 + - Motivation: Current Excel appears to have a preface row and 
         "Unnamed" columns. We will automatically detect the first row that
         contains candidate column names and re-read the file using that row
         as header.
         102 + ### Detection Strategy (precise)
         103 + - Read a raw preview with `pd.read_excel(DATA_FILE, 
         header=None, engine='openpyxl')`.
         104 + - Search only the first `search_rows = 20` rows for a header.
         105 + - Normalize each cell to string: lowercase, trim, replace 
         separators ([_-/:;.,]) to spaces, collapse spaces.
         106 + - Canonical fields and token rules (substring match):
         107 +   - agent_type: must contain both tokens ['agent', 'type'] in 
         any order
         108 +   - model_architecture: tokens ['model', 'architecture']
         109 +   - task_category: tokens at least ['task'] (optionally 
         'category')
         110 +   - multimodal_capability: contains 'multimodal' and one of 
         ['capability','capab','support','ability']
         111 +   - bias_detection: contains 'bias' and one of 
         ['detect','detection','score']
         112 + - Row is considered a header candidate if, across its cells, we
          can match at least TWO distinct canonical fields by the above rules.
          Choose the FIRST row that satisfies this ("首个包含候选列名的行").
         If none found, return None.
         113 + ### Implementation Changes
         114 + - Add `detect_header_row_from_raw(df_raw: pd.DataFrame, 
         search_rows: int = 20) -> Optional[int]` implementing the above
         logic.
         115 + - In `main()`:
         116 +   1) Read raw as `df_raw = pd.read_excel(DATA_FILE, 
         header=None, engine='openpyxl')`
         117 +   2) `hdr = detect_header_row_from_raw(df_raw)`
         118 +   3) If `hdr is not None`: re-read as `df = 
         pd.read_excel(DATA_FILE, header=hdr, engine='openpyxl')`; else:
         fallback `df = pd.read_excel(DATA_FILE, engine='openpyxl')`.
         119 +   4) Proceed with column detection, normalization, metrics, 
         charting, and HTML as before.
         120 + - Logging: print detected header row (0-based index) or "no 
         header detected".
         121 + - Safety: limit search to first 20 rows; if duplicate column 
         names arise, allow pandas default behavior; our flexible column
         detection copes.
         122 + ### Expected Outcome
         123 + - When the actual field names reside in a later row, the script
          will correctly identify it and produce full charts instead of
         placeholders.
         124 + SUPPLEMENTARY CHECKLIST:
         125 + 12. Implement `detect_header_row_from_raw` as specified.
         126 + 13. Modify `main()` to attempt two-pass read using the detected
          header row and log the decision.
         127 + 14. Re-run the script in venv; confirm that required columns 
         are detected and charts render (no placeholders if data present).
         128 + 15. Verify the counts card reflects increased processed_rows.
         129 + 16. Append results to REVIEW section if needed.

 ● [MODE: PLAN]

   计划补充已完成
   已将“自动检测首个包含候选列名的行作为表头，并据此重读 Excel”的策略以
   明确技术方案的形式补充进现有计划文件，并新增执行清单条目，准备在
   EXECUTE 阶段实施。
     • 已更新文件：
        • todo-2025-09-30--23-59.md
        • 新增章节：Supplement Plan: Auto-detect header row and re-read
          Excel
        • 新增 SUPPLEMENTARY CHECKLIST（条目 12–16）

   补充方案摘要
     • 在 main 中先用 header=None 读取原始表格的前若干行（默认
       20），按大小写不敏感与分隔符归一化规则对每行每格做字符串匹配。
     • 判断逻辑：如果某一行的所有单元格总计覆盖到至少两个不同“目标字段”的
       候选词（如 agent+type、model+architecture、multimodal+capab|suppor
       t|ability、bias+detect|score、task），则将该行视为“首个包含候选列
       名的行”，记录其行为 header 行号。
     • 若检测到有效 header 行，则使用该行号重新以 header=行号 读取
       Excel；否则回退为默认读取。
     • 随后继续列检测、归一化、统计与可视化流程。

   新增实施清单（SUPPLEMENTARY CHECKLIST）
     12. 实现 detect_header_row_from_raw（限定前 20
         行搜索，记录0基索引）。
     13. 修改 main：两段式读取（先 raw，再根据检测结果 header
         读正式数据），打印检测日志。
     14. 在 venv 中重跑脚本，确认能检测到目标列并渲染图表（若数据存在）。
     15. 验证页面计数卡 processed_rows 随数据识别而增加。
     16. 必要时在 todo 文件 REVIEW 区追加结果与结论。
   请发送“ENTER EXECUTE MODE”，我将严格按新增 SUPPLEMENTARY CHECKLIST
   12–16 步骤实施与验证。